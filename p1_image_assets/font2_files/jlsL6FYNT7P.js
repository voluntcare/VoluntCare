if (self.CavalryLogger) { CavalryLogger.start_js(["A3vbR"]); }

__d("ChatEmployeeAwayWarning",["MercuryIDs","MercuryParticipants","MercuryViewer"],(function a(b,c,d,e,f,g){__p&&__p();var h={updateEmployeeAwayWarning:function i(j,k,l){__p&&__p();c("MercuryParticipants").get(c("MercuryViewer").getID(),function(m){__p&&__p();var n=m.employee;if(n)c("MercuryParticipants").getMulti(j.participants,function(o){__p&&__p();var p=false,q=c("MercuryIDs").getUserIDFromThreadID(j.thread_id);if(!q)return;var m="fbid:"+q;for(var r in o)if(m==o[r].id&&o[r].is_employee_away)p=true;if(p)k();else l()})})}};f.exports=h}),null);
__d("XNativeComponentFlowBookingRequestCountController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/pages/platform/native-component-flow/booking_request_count/",{page_id:{type:"FBID",required:true},user_id:{type:"FBID",required:true}})}),null);
__d("FantaReducersTabSheets",["AsyncRequest","Bootloader","ChatEmployeeAwayWarning","ChatPrivacyActionController","ChatTimezoneWarning","ChatUserFocusWarning","ChatUserPersonalUserWarning","ChatUserWorkUserWarning","CurrentUser","FantaGetMessageActions","FantaMessageActions","FantaTabActions","FantaTabSheetActions","FBIDCheck","ImmutableObject","mercuryBlockedParticipantsRe","MercuryConfig","MercuryIDs","MercuryParticipants","MercurySheetPolicy","MercuryThreadInfo","MercuryThreads","MercuryViewer","MessageThreadAssociatedObjectUtils","RTCCallState","XNativeComponentFlowBookingRequestCountController","emptyFunction","ifRequired","setImmediate","gkx"],(function aa(ba,a,ca,da,b,ea){"use strict";__p&&__p();var c=a("mercuryBlockedParticipantsRe").get(),d=a("MercuryThreads").get(),e=a("FantaTabActions").Types,f=a("FantaGetMessageActions").Types,g=a("FantaMessageActions").Types,h=a("FantaTabSheetActions").Types;function i(U,V){switch(V.type){case e.CLOSE_TAB:case e.CLOSE_AND_TAB_NEXT:var W=V.tabID;if(!U.mercury.tabContents.get(W))return U;U=U.mergeIn(["mercury","tabContents",W],{typeahead:null});return j(U,W)}return U}function j(U,V,W){var X=U.mercury.tabContents.get(V);if(!X)return U;if(W&&X.openSheet!==W)return U;U=U.mergeIn(["mercury","tabContents",V],{openSheet:null});if(X.thread)U=Q(U,V,X.thread);return U}function k(U,V){__p&&__p();switch(V.type){case e.CLOSE_ALL_TABS:for(var W=U.mercury.tabContents.keys(),X=Array.isArray(W),Y=0,W=X?W:W[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var Z;if(X){if(Y>=W.length)break;Z=W[Y++]}else{Y=W.next();if(Y.done)break;Z=Y.value}var $=Z;U=U.mergeIn(["mercury","tabContents",$],{typeahead:null});U=j(U,$)}}return U}function l(U,V){switch(V.type){case f.ON_GET_THREAD_RESPONSE:case f.ON_GET_THREAD_PREVIEW_RESPONSE:var W=V.thread,X=V.tabID||W.thread_id;U=m(U,W,X)}return U}function m(U,V,W){var X=a("MercuryViewer").getID(),Y=V.participants.filter(function(Z){return Z!==X});if(Y.length<1&&!d.isNewEmptyLocalThread(W))U=r(U,W,a("MercurySheetPolicy").sheets.ChatNoRecipientsTabSheet);else U=j(U,W,a("MercurySheetPolicy").sheets.ChatNoRecipientsTabSheet);if(V.participants.length!==0)U=Q(U,W,V);return U}function n(U,V){switch(V.type){case f.THREADS_UPDATED:V.threads.forEach(function(W){U=m(U,new(a("ImmutableObject"))(W),W.thread_id)})}return U}function o(U,V){switch(V.type){case e.OPEN_TAB:case e.REPLACE_TAB:var W=V.tabID,X=U.mercury.tabContents.get(W).thread;if(X)U=Q(U,W,X)}return U}function p(U,V,W){if(a("MercuryThreadInfo").isMuted(W))return r(U,V,a("MercurySheetPolicy").sheets.ChatThreadIsMutedTabSheet);else return j(U,V,a("MercurySheetPolicy").sheets.ChatThreadIsMutedTabSheet)}function q(U,V,W){if(c.isMessageBlocked(W))return r(U,V,a("MercurySheetPolicy").sheets.ChatThreadIsMessageBlockedSheet);else return j(U,V,a("MercurySheetPolicy").sheets.ChatThreadIsMessageBlockedSheet)}function r(U,V,W){var X=U.mercury.tabContents.get(V),Y=U.tabGroup.tabs.get(V);if(!Y||!X)return U;var Z=X.openSheet;if(Z&&!a("MercurySheetPolicy").canReplaceOpenSheet(Z,W))return U;U=U.mergeIn(["mercury","tabContents",V],{openSheet:W});return U}function s(U,V){return U}function t(U,V){switch(V.type){case h.OPEN_APPOINTMENT_SHEET:var W=V.tabID;return r(U,W,a("MercurySheetPolicy").sheets.ChatAppointmentBanner)}return U}function u(U,V){switch(V.type){case h.OPEN_USER_FOCUS_SHEET:var W=V.tabID;return r(U,W,a("MercurySheetPolicy").sheets.ChatUserFocusSheet)}return U}function v(U,V){switch(V.type){case h.CLOSE_USER_FOCUS_AND_BYPASS_SHEET:var W=V.tabID;U=j(U,W,a("MercurySheetPolicy").sheets.ChatUserFocusSheet);U=j(U,W,a("MercurySheetPolicy").sheets.ChatUserFocusBypassSheet)}return U}function w(U,V,W){a("ChatUserFocusWarning").updateUserFocusWarning(W,function(X){X?a("setImmediate")(function(){a("FantaTabSheetActions").openBypassFocusSheet(V)}):a("setImmediate")(function(){a("FantaTabSheetActions").openUserFocusSheet(V)})},function(){a("setImmediate")(function(){a("FantaTabSheetActions").closeUserFocusAndBypassSheet(V)})});return U}function x(U,V){switch(V.type){case h.OPEN_BYPASS_FOCUS_SHEET:var W=V.tabID;return r(U,W,a("MercurySheetPolicy").sheets.ChatUserFocusBypassSheet)}return U}function y(U,V){switch(V.type){case h.OPEN_USER_TIMEZONE_SHEET:var W=V.tabID,X=V.timezoneInfo;if(!U.mercury.tabContents.get(W))return U;U=U.mergeIn(["mercury","tabContents",W],{timezoneInfo:X});return r(U,W,a("MercurySheetPolicy").sheets.ChatUserTimezoneSheet)}return U}function z(U,V){switch(V.type){case h.CLOSE_USER_TIMEZONE_SHEET:var W=V.tabID;if(!U.mercury.tabContents.get(W))return U;U=U.mergeIn(["mercury","tabContents",W],{timezoneInfo:null});U=j(U,W,a("MercurySheetPolicy").sheets.ChatUserTimezoneSheet)}return U}function A(U,V,W){a("ChatTimezoneWarning").updateUserTimezoneWarning(W,function(X){a("setImmediate")(function(){a("FantaTabSheetActions").openUserTimezoneSheet(V,X)})},function(){a("setImmediate")(function(){a("FantaTabSheetActions").closeUserTimezoneSheet(V)})});return U}function B(U,V,W){a("ChatEmployeeAwayWarning").updateEmployeeAwayWarning(W,function(){return a("setImmediate")(function(){a("FantaTabSheetActions").openEmployeeAwaySheet(V)})},a("emptyFunction"));return U}function C(U,V){switch(V.type){case h.OPEN_EMPLOYEE_AWAY_SHEET:var W=V.tabID;U=r(U,W,a("MercurySheetPolicy").sheets.ChatEmployeeAwaySheet)}return U}function D(U,V,W){a("ChatUserPersonalUserWarning").updateEmployeePersonalUserWarning(W,function(X,Y){a("setImmediate")(function(){a("FantaTabSheetActions").openEmployeePersonalUserSheet(V)})},a("emptyFunction"));return U}function E(U,V){switch(V.type){case h.OPEN_EMPLOYEE_PERSONAL_USER_SHEET:var W=V.tabID;U=r(U,W,a("MercurySheetPolicy").sheets.ChatUserIsPersonalUserSheet)}return U}function F(U,V){switch(V.type){case h.CLOSE_EMPLOYEE_PERSONAL_USER_SHEET:var W=V.tabID;U=j(U,W,a("MercurySheetPolicy").sheets.ChatUserIsPersonalUserSheet)}return U}function G(U,V){switch(V.type){case h.OPEN_EMPLOYEE_WORK_USER_SHEET:var W=V.tabID;U=r(U,W,a("MercurySheetPolicy").sheets.ChatUserIsWorkUserSheet)}return U}function H(U,V){switch(V.type){case h.CLOSE_EMPLOYEE_WORK_USER_SHEET:var W=V.tabID;U=j(U,W,a("MercurySheetPolicy").sheets.ChatUserIsWorkUserSheet)}return U}function I(U,V,W){a("ChatUserWorkUserWarning").updateEmployeeWorkUserWarning(W,function(X,Y){a("setImmediate")(function(){a("FantaTabSheetActions").openEmployeeWorkUserSheet(V)})},a("emptyFunction"));return U}function J(U,V){switch(V.type){case h.OPEN_NAME_CONVERSATION_TAB_SHEET:return r(U,V.tabID,a("MercurySheetPolicy").sheets.ChatNameConversationTabSheet)}return U}function K(U,V){switch(V.type){case h.CLOSE_NAME_CONVERSATION_TAB_SHEET:return j(U,V.tabID,a("MercurySheetPolicy").sheets.ChatNameConversationTabSheet)}return U}function L(U,V){return U}function M(U,V){switch(V.type){case h.OPEN_READ_ONLY_PERMANENT_SHEET:return r(U,V.tabID,a("MercurySheetPolicy").sheets.ChatReadOnlyPermanentTabSheet)}return U}function N(U,V){switch(V.type){case h.CLOSE_READ_ONLY_PERMANENT_SHEET:return j(U,V.tabID,a("MercurySheetPolicy").sheets.ChatReadOnlyPermanentTabSheet)}return U}function O(U,V){switch(V.type){case h.OPEN_READ_ONLY_SHEET:return r(U,V.tabID,a("MercurySheetPolicy").sheets.ChatReadOnlyTabSheet)}return U}function P(U,V){switch(V.type){case h.CLOSE_READ_ONLY_SHEET:return j(U,V.tabID,a("MercurySheetPolicy").sheets.ChatReadOnlyTabSheet)}return U}function fa(U,V){return U}function ga(U,V){return U}function ha(U,V){return U}function ia(U,V){switch(V.type){case h.CLOSE_ADD_FRIENDS_SHEET:var W=V.tabID;if(!U.mercury.tabContents.get(W))return U;U=U.mergeIn(["mercury","tabContents",W],{typeahead:null});return j(U,W,a("MercurySheetPolicy").sheets.FantaAddFriendsSheet)}return U}function ja(U,V){switch(V.type){case h.CLOSE_ADD_MORE_FRIENDS_SHEET:var W=V.tabID;if(!U.mercury.tabContents.get(W))return U;U=U.mergeIn(["mercury","tabContents",W],{typeahead:null});return j(U,W,a("MercurySheetPolicy").sheets.FantaAddMoreFriendsSheet)}return U}function ka(U,V){switch(V.type){case g.SEND_GROUP_MESSAGE:var W=V.tabID||V.threadID;return j(U,W,a("MercurySheetPolicy").sheets.FantaAddMoreFriendsSheet)}return U}function la(U,V){switch(V.type){case g.RECEIVED_NEW_MESSAGE:var W=V.tabID,X=U.mercury.tabContents.get(W);if(X&&!X.isScrolledToBottom)U=r(U,W,a("MercurySheetPolicy").sheets.ChatNewMessagesTabSheet);else U=j(U,W,a("MercurySheetPolicy").sheets.ChatNewMessagesTabSheet)}return U}function ma(U,V){switch(V.type){case e.SCROLL_BOTTOM_CHANGED:var W=V.tabID,X=V.isScrolledToBottom;if(X)U=j(U,W,a("MercurySheetPolicy").sheets.ChatNewMessagesTabSheet);var Y=U.mercury.tabContents.get(W);if(Y&&Y.thread)U=R(U,W,Y.thread)}return U}function na(U,V){__p&&__p();switch(V.type){case f.ON_PRIVACY_STATE_CHANGE:var W=V.threadID,X=V.privacyState;switch(X){case a("ChatPrivacyActionController").OFFLINE:U=j(U,W,a("MercurySheetPolicy").sheets.ChatUserBlockedTabSheet);U=r(U,W,a("MercurySheetPolicy").sheets.ChatOfflineTabSheet);break;case a("ChatPrivacyActionController").NORMAL:U=j(U,W,a("MercurySheetPolicy").sheets.ChatUserBlockedTabSheet);U=j(U,W,a("MercurySheetPolicy").sheets.ChatOfflineTabSheet);break;case a("ChatPrivacyActionController").BLOCKED:U=j(U,W,a("MercurySheetPolicy").sheets.ChatOfflineTabSheet);var Y=a("MercuryIDs").getUserIDFromThreadID(W);if(Y){var Z=a("MercuryParticipants").getNow(a("MercuryIDs").getParticipantIDFromUserID(Y));Z&&Z.is_friend?U=r(U,W,a("MercurySheetPolicy").sheets.ChatUserBlockedTabSheet):U=j(U,W,a("MercurySheetPolicy").sheets.ChatUserBlockedTabSheet)}break}}return U}function oa(U,V){switch(V.type){case h.ON_IS_PAGE_TAB:var W=V.tabID,X=V.pageIndicator,Y=U.mercury.tabContents.get(W);if(!Y)return U;U=U.mergeIn(["mercury","tabContents",W],{pageIndicator:X})}return U}function Q(U,V,W){__p&&__p();U=w(U,V,W);U=A(U,V,W);U=q(U,V,W);U=p(U,V,W);U=B(U,V,W);U=D(U,V,W);U=I(U,V,W);U=S(U,V,W);U=ra(U,V,W);U=R(U,V,W);U=pa(U,V,W);U=sa(U,V,W);return U}function pa(U,V,W){var X=W.rtc_call_data,Y=W.thread_fbid,Z=X&&X.call_state!==a("RTCCallState").NO_ONGOING_CALL&&Y;if(Z)U=r(U,V,a("MercurySheetPolicy").sheets.ChatJoinCallSheet);else U=j(U,V,a("MercurySheetPolicy").sheets.ChatJoinCallSheet);return U}function R(U,V,W){var X=W.has_montage&&a("MercuryConfig").MontageThreadViewer,Y=U.mercury.tabContents.get(V),Z=!!(Y&&Y.isScrolledToBottom);if(Z&&X)U=r(U,V,a("MercurySheetPolicy").sheets.ChatMontageSheet);else U=j(U,V,a("MercurySheetPolicy").sheets.ChatMontageSheet);return U}function S(U,V,W){__p&&__p();a("ifRequired")("EventReminderActions",function(X){__p&&__p();var event=void 0;if(W.associated_object&&W.associated_object.room_type==="EVENT"){event=W.associated_object;X.updateEventReminder(V,event,W.participants_event_status)}else if(W.lightweight_event){event=W.lightweight_event;X.updateEventReminder(V,event)}if(event)U=r(U,V,a("MercurySheetPolicy").sheets.ChatEventReminderTabSheet);else a("ifRequired")("EventReminderStateStore",function(Y){var Z=Y.getEvent(V);if(Z&&Z.exists)X.deleteEventReminder(V);U=j(U,V,a("MercurySheetPolicy").sheets.ChatEventReminderTabSheet)},function(){return T(V)})},function(){return T(V)});return U}function T(U){a("Bootloader").loadModules(["EventReminderActions","EventReminderStateStore"],function(V,W){a("setImmediate")(function(){a("FantaTabSheetActions").onBootloadEventReminder(U)})},"FantaReducersTabSheets")}function qa(U,V){switch(V.type){case h.ON_BOOTLOAD_EVENT_REMINDER:var W=V.tabID,X=U.mercury.tabContents.get(W);if(!X)return U;var Y=X.thread;if(Y)U=S(U,W,Y)}return U}function ra(U,V,W){__p&&__p();var X=W.other_user_fbid;if(X&&!a("FBIDCheck").isUser_deprecated(X)&&a("gkx")("AT6lRFQLpQZ6UWlPrB9gInaarooSpaHqBAt5ho6-RghBTrVcE-XKcrf8CtnjJLZJDFVcDhkmvsbKnTVqx76gSACvoOe9JNcrEBY54bqb1L214A")){var Y=a("XNativeComponentFlowBookingRequestCountController").getURIBuilder().setFBID("page_id",X).setFBID("user_id",a("CurrentUser").getID()).getURI();new(a("AsyncRequest"))().setURI(Y).setHandler(function(Z){var $=Z&&Z.getPayload();if($&&$.confirmed+$.pending>0)a("FantaTabSheetActions").openAppointmentBannerSheet(V)}).send()}else U=j(U,V,a("MercurySheetPolicy").sheets.ChatAppointmentBanner);return U}function sa(U,V,W){var X=W.associated_object;if(a("MessageThreadAssociatedObjectUtils").shouldRender(X))U=r(U,V,a("MercurySheetPolicy").sheets.ChatRoomAssociatedObjectSheet);return U}b.exports={closeAddFriends:ia,closeAddMoreFriends:ja,closeAllTabs:k,closeEmployeePersonalUserSheet:F,closeEmployeeWorkUserSheet:H,closeFocusUserSheet:v,closeNameConversationSheet:K,closePermanentReadOnlySheet:N,closeReadOnlySheet:P,closeTab:i,closeUserTimezoneSheet:z,onBootloadEventReminder:qa,onGetThreadResponse:l,onIsPageTab:oa,onPrivacyStateChange:na,openAddFriendsSheet:s,openAppointmentBannerSheet:t,openBypassFocusSheet:x,openEmployeeAwaySheet:C,openEmployeePersonalUserSheet:E,openEmployeeWorkUserSheet:G,openFocusUserSheet:u,openNameConversationSheet:J,openNewMessagesSheet:L,openPermanentReadOnlySheet:M,openReadOnlySheet:O,openTab:o,openUploadWarningTabSheet:fa,openUserFocusSheet:ga,openUserIsPersonalUserSheet:ha,openUserTimezoneSheet:y,receivedNewMessage:la,scrollBottomChanged:ma,sendGroupMessage:ka,threadsUpdated:n}}),null);